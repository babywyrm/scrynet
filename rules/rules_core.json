[
  {
    "name": "Database Root Password",
    "pattern": "(?i)(root|admin|sa)\\s*[\"']\\s*:\\s*[\"'](password|admin|root|123456|''|\"\")",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "Default/weak database credentials",
    "remediation": "Change default passwords immediately."
  },
  {
    "name": "Environment Variable Secrets",
    "pattern": "(?i)(AWS_SECRET_ACCESS_KEY|GITHUB_TOKEN|PRIVATE_KEY)\\s*=\\s*[\"'][^\"']{20,}[\"']",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "Hardcoded environment secrets",
    "remediation": "Use secure secret management."
  },
  {
    "name": "JWT Algorithm None",
    "pattern": "(?i)jwt.*(none|algorithm_none)",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "JWT 'alg' header set to 'none', which can allow signature bypass.",
    "remediation": "Reject JWTs with the 'none' algorithm on the server-side."
  },
  {
    "name": "Password in URL",
    "pattern": "(?i)(http|ftp)s?://[^/]*:[^@]*@",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "Credentials in URL",
    "remediation": "Use secure authentication methods."
  },
  {
    "name": "SSH Private Key Exposed",
    "pattern": "(?i)-----BEGIN (RSA|OPENSSH|DSA|EC) PRIVATE KEY-----",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "SSH private key in code",
    "remediation": "Remove private key and regenerate keypair."
  },
  {
    "name": "Weak JWT Secret",
    "pattern": "(?i)(jwt|secret|signing_key)\\s*[:=]\\s*['\"](secret|password|123456|admin)['\"]",
    "severity": "CRITICAL",
    "category": "A02",
    "description": "A weak, easily guessable secret is used for signing JWTs.",
    "remediation": "Use a long, high-entropy, randomly generated secret for signing JWTs."
  },
  {
    "name": "Command Exec",
    "pattern": "(?i)(system|exec)\\s*\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "System/exec call - immediate RCE risk",
    "remediation": "Use allow-lists & sanitize args."
  },
  {
    "name": "Go exec.CommandContext",
    "pattern": "(?i)exec\\.CommandContext\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "exec.CommandContext - command execution",
    "remediation": "Sanitize args; use allow-lists."
  },
  {
    "name": "JS Function Constructor",
    "pattern": "(?i)new\\s+Function\\s*\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Dynamic code via Function constructor",
    "remediation": "Avoid new Function(); use static code."
  },
  {
    "name": "JS eval with template literals",
    "pattern": "(?i)eval\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "eval() - direct code execution",
    "remediation": "Avoid eval(); use safe parsing."
  },
  {
    "name": "MongoDB NoSQL Injection",
    "pattern": "(?i)db\\.collection\\([^)]*\\$where[^)]*\\)",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "MongoDB $where injection vulnerability",
    "remediation": "Use parameterized queries, avoid $where operator."
  },
  {
    "name": "Mongoose findByIdAndUpdate with req.body",
    "pattern": "(?i)(findByIdAndUpdate|findOneAndUpdate)\\s*\\([^,]+,\\s*req\\.body",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Mongoose update with raw req.body allows NoSQL operator injection ($set, $where, etc.)",
    "remediation": "Whitelist fields: { $set: { title: req.body.title, content: req.body.content } }"
  },
  {
    "name": "Mongoose Model.update with req.body",
    "pattern": "(?i)\\.(update|updateOne|updateMany)\\s*\\([^)]*req\\.body",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Mongoose update with raw req.body allows NoSQL operator injection",
    "remediation": "Whitelist fields; never pass req.body directly as update document."
  },
  {
    "name": "Express req.body to ORM create",
    "pattern": "(?i)(\\.create|\\.insert)\\s*\\(\\s*req\\.body",
    "severity": "HIGH",
    "category": "A01",
    "description": "Mass assignment - req.body passed directly to create/insert",
    "remediation": "Whitelist permitted fields explicitly."
  },
  {
    "name": "Node req.params in MongoDB query",
    "pattern": "(?i)(findOne|findById)\\s*\\(\\s*\\{\\s*_id\\s*:\\s*req\\.(params|query)",
    "severity": "HIGH",
    "category": "A03",
    "description": "User-controlled ID in MongoDB query - potential NoSQL injection or IDOR",
    "remediation": "Validate/sanitize ID; use Mongoose ObjectId validation."
  },
  {
    "name": "PHP Unserialize",
    "pattern": "(?i)unserialize\\s*\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Untrusted data passed to unserialize()",
    "remediation": "Avoid PHP unserialize; use JSON or safe parsers."
  },
  {
    "name": "Python os.system",
    "pattern": "(?i)os\\.system\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "os.system call - direct shell execution",
    "remediation": "Use subprocess with shell=False."
  },
  {
    "name": "Remote Code Execution PHP",
    "pattern": "(?i)(\\$_(?:GET|POST|REQUEST)\\s*\\[.*\\].*(?:file_get_contents|include|require)|create_function\\s*\\()",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "PHP RCE pattern",
    "remediation": "Validate and sanitize all user input."
  },
  {
    "name": "SQL Injection Obvious",
    "pattern": "(?i)(union\\s+select.*from|' or '1'='1|' or 1=1|admin'--)",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Obvious SQL injection pattern",
    "remediation": "Use parameterized queries immediately."
  },
  {
    "name": "Web Shell Pattern",
    "pattern": "(?i)(\\$_(?:GET|POST|REQUEST)\\s*\\[.*\\].*(?:eval|system|exec)|assert\\s*\\(\\s*\\$_)",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "PHP web shell pattern",
    "remediation": "Remove web shell immediately."
  },
  {
    "name": "Direct System File Access",
    "pattern": "(?i)(/etc/passwd|/etc/shadow|/etc/hosts|C:\\\\Windows\\\\System32)",
    "severity": "CRITICAL",
    "category": "A05",
    "description": "Direct system file access",
    "remediation": "Avoid direct system file manipulation."
  },
  {
    "name": "XSS Obvious",
    "pattern": "(?i)(<script>alert\\(|<img.*onerror=|javascript:alert\\()",
    "severity": "CRITICAL",
    "category": "A07",
    "description": "Obvious XSS payload",
    "remediation": "Sanitize and escape all user input."
  },
  {
    "name": "Backdoor Shell Command",
    "pattern": "(?i)(nc\\s+-l|netcat.*-l|bash\\s+-i|sh\\s+-i|/bin/sh.*-i)",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "Reverse shell/backdoor pattern",
    "remediation": "Remove malicious code immediately."
  },
  {
    "name": "Buffer Overflow Pattern",
    "pattern": "(?i)(strcpy\\s*\\(|gets\\s*\\(|sprintf\\s*\\(.*%s)",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "Buffer overflow vulnerable function",
    "remediation": "Use safe string functions (strncpy, fgets, snprintf)."
  },
  {
    "name": "Crypto Mining",
    "pattern": "(?i)(stratum\\+tcp|mining\\.pool|xmrig|monero|bitcoin.*pool|cryptonight)",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "Cryptocurrency mining code",
    "remediation": "Remove unauthorized mining code."
  },
  {
    "name": "Malicious Domain",
    "pattern": "(?i)(evil\\.com|malware\\.site|c2\\.server|badactor\\.net)",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "Known malicious domain reference",
    "remediation": "Remove malicious domain references."
  },
  {
    "name": "Unrestricted File Upload",
    "pattern": "(?i)(move_uploaded_file|file_get_contents\\(\\$_FILES|uploadedfile\\.save)",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "File upload without validation",
    "remediation": "Validate file types, scan uploads, restrict execution."
  },
  {
    "name": "XStream Deserialization",
    "pattern": "(?i)new\\s+XStream\\s*\\(",
    "severity": "CRITICAL",
    "category": "A08",
    "description": "XStream deserialization can lead to RCE",
    "remediation": "Disable untrusted types or use safe libraries."
  },
  {
    "name": "Data Exfiltration",
    "pattern": "(?i)(curl.*-X\\s+POST.*\\.(pastebin|hastebin|discord|telegram)|wget.*evil|base64.*decode.*sh)",
    "severity": "CRITICAL",
    "category": "A09",
    "description": "Potential data exfiltration",
    "remediation": "Investigate and remove malicious code."
  },
  {
    "name": "Angular Direct DOM Access",
    "pattern": "(?i)(?:bypassSecurityTrust\\w+)",
    "severity": "HIGH",
    "category": "A01",
    "description": "Angular security bypass",
    "remediation": "Avoid sanitization bypass."
  },
  {
    "name": "Direct Object Reference",
    "pattern": "(?i)(SELECT.*WHERE\\s+id\\s*=|users/\\{\\w+\\}|/user/\\d+)",
    "severity": "HIGH",
    "category": "A01",
    "description": "Potential IDOR vulnerability",
    "remediation": "Implement proper authorization checks."
  },
  {
    "name": "Flask Input",
    "pattern": "(?i)(request\\.args|getattr\\(request, )",
    "severity": "HIGH",
    "category": "A01",
    "description": "Unvalidated Flask input",
    "remediation": "Validate Flask request data explicitly."
  },
  {
    "name": "Go FormValue",
    "pattern": "(?i)r\\.FormValue\\(",
    "severity": "HIGH",
    "category": "A01",
    "description": "Unvalidated form input",
    "remediation": "Validate & sanitize all form inputs."
  },
  {
    "name": "Go Missing Auth Check",
    "pattern": "(?i)http\\.HandleFunc\\([\"'][^\"']+[\"'],\\s*func\\s*\\([^)]+\\)\\s*{.*return\\s*\\}",
    "severity": "HIGH",
    "category": "A01",
    "description": "Endpoint without proper authentication",
    "remediation": "Implement authentication middleware."
  },
  {
    "name": "Insecure File Permissions",
    "pattern": "(?i)chmod\\s+0?777",
    "severity": "HIGH",
    "category": "A01",
    "description": "Files made world-writable",
    "remediation": "Use least-privilege permissions."
  },
  {
    "name": "Java Servlet getHeader",
    "pattern": "(?i)request\\.getHeader\\(",
    "severity": "HIGH",
    "category": "A01",
    "description": "Header input unchecked",
    "remediation": "Validate & sanitize headers."
  },
  {
    "name": "Java getParameter",
    "pattern": "(?i)request\\.getParameter\\(",
    "severity": "HIGH",
    "category": "A01",
    "description": "Unvalidated request parameter",
    "remediation": "Use input validation frameworks."
  },
  {
    "name": "Node req.query/body",
    "pattern": "(?i)(req\\.body|req\\.query)\\s*[\\.\\[]",
    "severity": "HIGH",
    "category": "A01",
    "description": "Unvalidated Node.js request input",
    "remediation": "Use libraries like joi or express-validator."
  },
  {
    "name": "Spring Security Disabled",
    "pattern": "(?i)http\\.csrf\\(\\)\\.disable\\(\\)",
    "severity": "HIGH",
    "category": "A01",
    "description": "CSRF disabled",
    "remediation": "Enable CSRF protection."
  },
  {
    "name": "AES ECB Mode",
    "pattern": "(?i)AES/ECB/NoPadding",
    "severity": "HIGH",
    "category": "A02",
    "description": "AES in ECB mode is insecure",
    "remediation": "Use CBC or GCM modes with IV."
  },
  {
    "name": "API Key",
    "pattern": "(?i)(api[_-]?key|secret)\\s*=\\s*[\"'][^\"']+[\"']",
    "severity": "HIGH",
    "category": "A02",
    "description": "API key in code",
    "remediation": "Use secure secret storage."
  },
  {
    "name": "Hardcoded IV",
    "pattern": "(?i)(?:iv\\s*=\\s*[\"'][0-9a-f]+[\"']|InitializationVector\\s*\\(\\s*[\"'][0-9a-f]+[\"']\\))",
    "severity": "HIGH",
    "category": "A02",
    "description": "Hardcoded initialization vector",
    "remediation": "Generate fresh IVs for each operation."
  },
  {
    "name": "Hardcoded Password",
    "pattern": "(?i)password\\s*=\\s*[\"'][^\"']+[\"']",
    "severity": "HIGH",
    "category": "A02",
    "description": "Credentials in code",
    "remediation": "Use environment variables or vaults."
  },
  {
    "name": "Hardcoded RSA Key",
    "pattern": "(?i)privateKey\\s*=\\s*[\"'][^\"']+[\"']",
    "severity": "HIGH",
    "category": "A02",
    "description": "RSA key in code",
    "remediation": "Use secure key mgmt."
  },
  {
    "name": "JWT Secret",
    "pattern": "(?i)(jwt.*secret|signingkey)\\s*=\\s*[\"'][^\"']+[\"']",
    "severity": "HIGH",
    "category": "A02",
    "description": "JWT secret in code",
    "remediation": "Use env-vars or vaults."
  },
  {
    "name": "Weak Cipher",
    "pattern": "(?i)Cipher\\.getInstance\\([\"']?(DES|RC4|MD5|SHA1)[\"']?\\)",
    "severity": "HIGH",
    "category": "A02",
    "description": "Weak cipher use",
    "remediation": "Use AES-GCM or better."
  },
  {
    "name": "Weak Encryption Key Size",
    "pattern": "(?i)(?:key(?:length|size|bits)\\s*=\\s*(?:512|1024)|RSA\\.\\w+\\(\\s*(?:512|1024)\\s*\\))",
    "severity": "HIGH",
    "category": "A02",
    "description": "Insufficient encryption key size",
    "remediation": "Use at least 2048-bit RSA, 256-bit ECC."
  },
  {
    "name": "CRLF Injection",
    "pattern": "(?i)(%0d%0a|\\\\r\\\\n)",
    "severity": "HIGH",
    "category": "A03",
    "description": "CRLF injection risk",
    "remediation": "Strip or encode newline sequences."
  },
  {
    "name": "GraphQL Injection",
    "pattern": "(?i)gql(?:['\"])\\s*\\$\\{(?:[^\\}]*?)\\}",
    "severity": "HIGH",
    "category": "A03",
    "description": "GraphQL injection vulnerability",
    "remediation": "Use GraphQL variables instead of interpolation."
  },
  {
    "name": "Java PreparedStatement Concatenation",
    "pattern": "(?i)createStatement\\(\\)\\.executeQuery\\(\".*\"\\s*\\+\\s*.*\\)",
    "severity": "HIGH",
    "category": "A03",
    "description": "SQL concatenation",
    "remediation": "Use parameterized queries."
  },
  {
    "name": "LDAP Injection",
    "pattern": "(?i)ldap\\.search(?:Request)?\\s*\\(.+\\+.+\\)",
    "severity": "HIGH",
    "category": "A03",
    "description": "LDAP injection vulnerability",
    "remediation": "Escape LDAP special characters."
  },
  {
    "name": "Log Injection",
    "pattern": "(?i)log\\.(info|warn|error|debug)\\s*\\(.*(\\n|%0a|%0d).*",
    "severity": "HIGH",
    "category": "A03",
    "description": "Newline characters are being logged, which can lead to log injection or log spoofing.",
    "remediation": "Sanitize all data before logging to remove or encode newline characters."
  },
  {
    "name": "Python Vulnerable Templating",
    "pattern": "(?i)(?:Template\\s*\\(.*request|render_template_string\\()",
    "severity": "HIGH",
    "category": "A03",
    "description": "Template injection vulnerability",
    "remediation": "Never pass user data directly to templates."
  },
  {
    "name": "SQL String Concatenation",
    "pattern": "(?i)(?:query|sql|db\\.)(?:Execute|Query)\\s*\\(\\s*(?:[f]?[\"']SELECT|[f]?[\"']INSERT|[f]?[\"']UPDATE|[f]?[\"']DELETE).*?\\+.*?\\)",
    "severity": "HIGH",
    "category": "A03",
    "description": "SQL injection via concatenation",
    "remediation": "Use parameterized queries."
  },
  {
    "name": "SSTI Jinja2 Environment",
    "pattern": "(?i)jinja2\\.Environment\\(",
    "severity": "HIGH",
    "category": "A03",
    "description": "Potential SSTI via Jinja2 Environment",
    "remediation": "Avoid dynamic template creation."
  },
  {
    "name": "XXE/XML External Entity",
    "pattern": "(?i)<!DOCTYPE\\s+[^>]*\\s+SYSTEM\\s+[\"'][^\"']+[\"']",
    "severity": "HIGH",
    "category": "A03",
    "description": "Possible XXE declaration",
    "remediation": "Disable DTD/ENTITY processing in XML parsers."
  },
  {
    "name": "Open CORS in Spring",
    "pattern": "(?i)allowedOrigins\\s*=\\s*\"\\*\"",
    "severity": "HIGH",
    "category": "A05",
    "description": "CORS allows any origin",
    "remediation": "Restrict CORS to specific domains."
  },
  {
    "name": "Path Traversal",
    "pattern": "(?i)\\.\\./\\.\\./",
    "severity": "HIGH",
    "category": "A05",
    "description": "Potential path traversal",
    "remediation": "Validate and canonicalize file paths."
  },
  {
    "name": "Session Cookie",
    "pattern": "(?i)Set-Cookie:",
    "severity": "HIGH",
    "category": "A05",
    "description": "Set-Cookie header found",
    "remediation": "Ensure Secure and HttpOnly flags are present."
  },
  {
    "name": "Simple Path Traversal",
    "pattern": "(?i)\\.\\.[/\\\\]",
    "severity": "HIGH",
    "category": "A05",
    "description": "Potential path traversal sequence",
    "remediation": "Validate and canonicalize file paths."
  },
  {
    "name": "Spring Boot Actuators Exposed",
    "pattern": "management\\.endpoints\\.web\\.exposure\\.include\\s*=\\s*\\*",
    "severity": "HIGH",
    "category": "A05",
    "description": "Spring Boot Actuator endpoints are exposed to the public, leaking sensitive information.",
    "remediation": "Restrict actuator endpoint exposure in production environments."
  },
  {
    "name": "TLS SkipVerify",
    "pattern": "(?i)InsecureSkipVerify\\s*:\\s*true",
    "severity": "HIGH",
    "category": "A05",
    "description": "TLS Verify disabled",
    "remediation": "Enable certificate validation."
  },
  {
    "name": "Go Old Gin Version",
    "pattern": "github\\.com/gin-gonic/gin v1\\.3\\.\\d+",
    "severity": "HIGH",
    "category": "A06",
    "description": "Old Gin framework",
    "remediation": "Upgrade Gin to latest."
  },
  {
    "name": "Known Vuln Lib",
    "pattern": "(?i)(flask==0\\.10|lodash@3)",
    "severity": "HIGH",
    "category": "A06",
    "description": "Vulnerable library version",
    "remediation": "Update dependencies."
  },
  {
    "name": "NPM Audit Bypass",
    "pattern": "(?i)npm\\s+audit\\s+--omit=dev",
    "severity": "HIGH",
    "category": "A06",
    "description": "Skipping dev vulnerabilities",
    "remediation": "Run full audit and fix issues."
  },
  {
    "name": "Old AngularJS",
    "pattern": "angular\\.module\\(",
    "severity": "HIGH",
    "category": "A06",
    "description": "Legacy AngularJS",
    "remediation": "Migrate to Angular 2+."
  },
  {
    "name": "Old jQuery",
    "pattern": "jquery-1\\.(3|4|5|6|7|8|9)",
    "severity": "HIGH",
    "category": "A06",
    "description": "Legacy jQuery",
    "remediation": "Upgrade to latest jQuery."
  },
  {
    "name": "Python Requests Old Version",
    "pattern": "requests==2\\.18\\.\\d+",
    "severity": "HIGH",
    "category": "A06",
    "description": "Old requests lib",
    "remediation": "Upgrade requests package."
  },
  {
    "name": "Auth Disabled",
    "pattern": "(?i)auth\\s*=\\s*false",
    "severity": "HIGH",
    "category": "A07",
    "description": "Authentication turned off in config",
    "remediation": "Require auth for all endpoints."
  },
  {
    "name": "Go html/template Unsafe",
    "pattern": "(?i)template\\.HTML\\(",
    "severity": "HIGH",
    "category": "A07",
    "description": "template.HTML use",
    "remediation": "Use auto-escaping templates."
  },
  {
    "name": "JS document.cookie",
    "pattern": "(?i)document\\.cookie",
    "severity": "HIGH",
    "category": "A07",
    "description": "Cookie access in JS",
    "remediation": "Avoid direct cookie use; use HttpOnly."
  },
  {
    "name": "Python Flask Markup Unsafe",
    "pattern": "(?i)Markup\\(.*\\)",
    "severity": "HIGH",
    "category": "A07",
    "description": "Flask Markup()",
    "remediation": "Use safe rendering; escape data."
  },
  {
    "name": "Raw Jinja2",
    "pattern": "(?i){{\\s*[^}]+\\s*}}",
    "severity": "HIGH",
    "category": "A07",
    "description": "Unescaped template",
    "remediation": "Use safe filters or escape."
  },
  {
    "name": "innerHTML",
    "pattern": "(?i)\\.innerHTML\\s*=",
    "severity": "HIGH",
    "category": "A07",
    "description": "innerHTML assignment",
    "remediation": "Use textContent or sanitize."
  },
  {
    "name": "jQuery .html()",
    "pattern": "(?i)\\$\\(.+\\)\\.html\\(",
    "severity": "HIGH",
    "category": "A07",
    "description": "jQuery .html()",
    "remediation": "Use .text() or sanitize."
  },
  {
    "name": "Dependency Confusion Install Command",
    "pattern": "(?i)(npm\\s+install|pip\\s+install|go\\s+get)\\s+http://",
    "severity": "HIGH",
    "category": "A08",
    "description": "Installing packages over HTTP",
    "remediation": "Use only HTTPS package registries."
  },
  {
    "name": "Go: exec w/ download",
    "pattern": "(?i)http\\.Get.*\\|\\s*exec\\.Command",
    "severity": "HIGH",
    "category": "A08",
    "description": "Exec downloaded code",
    "remediation": "Verify & sign before exec."
  },
  {
    "name": "Java Deserialization",
    "pattern": "(?i)new\\s+ObjectInputStream\\(",
    "severity": "HIGH",
    "category": "A08",
    "description": "Java deserialization vulnerability",
    "remediation": "Avoid native deserialization; use safe formats."
  },
  {
    "name": "JavaScript Prototype Pollution",
    "pattern": "(__proto__|constructor\\.prototype)",
    "severity": "HIGH",
    "category": "A08",
    "description": "Direct modification of '__proto__' or 'constructor.prototype' can lead to prototype pollution.",
    "remediation": "Sanitize user input to prevent modification of object prototypes. Use Object.create(null) for maps."
  },
  {
    "name": "Python YAML load",
    "pattern": "(?i)yaml\\.load\\(",
    "severity": "HIGH",
    "category": "A08",
    "description": "Unsafe YAML load",
    "remediation": "Use yaml.safe_load instead."
  },
  {
    "name": "Python pickle load",
    "pattern": "(?i)pickle\\.load\\(",
    "severity": "HIGH",
    "category": "A08",
    "description": "pickle.load()",
    "remediation": "Avoid pickle; use safe formats."
  },
  {
    "name": "Shell curl + sh",
    "pattern": "curl.*\\|\\s*sh",
    "severity": "HIGH",
    "category": "A08",
    "description": "curl | sh",
    "remediation": "Download, verify, then exec."
  },
  {
    "name": "Sensitive Data in Logs",
    "pattern": "(?i)(console\\.(log|info|error)|logger\\.(info|error)).*\\b(pass(word)?|token|secret|ssn)\\b",
    "severity": "HIGH",
    "category": "A09",
    "description": "Credentials or PII in logs",
    "remediation": "Mask or remove sensitive data from logs."
  },
  {
    "name": "Silent Catch",
    "pattern": "(?i)catch\\s*\\([^)]*\\)\\s*\\{\\s*\\}",
    "severity": "HIGH",
    "category": "A09",
    "description": "Exception handler is empty",
    "remediation": "Log or handle exceptions appropriately."
  },
  {
    "name": "Axios SSRF",
    "pattern": "(?i)axios\\.(get|post|put|delete)\\s*\\(",
    "severity": "HIGH",
    "category": "A10",
    "description": "Potential SSRF via axios request",
    "remediation": "Whitelist/validate external URLs."
  },
  {
    "name": "Go SSRF",
    "pattern": "http\\.Get\\([^)]+\\)",
    "severity": "HIGH",
    "category": "A10",
    "description": "Unvalidated http.Get",
    "remediation": "Whitelist URLs/domains."
  },
  {
    "name": "Go net/http Get",
    "pattern": "(?i)http\\.Get\\(",
    "severity": "HIGH",
    "category": "A10",
    "description": "http.Get()",
    "remediation": "Whitelist URLs/domains."
  },
  {
    "name": "Java URL openStream",
    "pattern": "(?i)new\\s+URL\\([^)]*\\)\\.openStream\\(",
    "severity": "HIGH",
    "category": "A10",
    "description": "URL.openStream",
    "remediation": "Whitelist remote endpoints."
  },
  {
    "name": "Node.js http.request",
    "pattern": "(?i)http\\.request\\(",
    "severity": "HIGH",
    "category": "A10",
    "description": "http.request",
    "remediation": "Whitelist URLs/domains."
  },
  {
    "name": "Python SSRF",
    "pattern": "requests\\.get\\([^)]+\\)",
    "severity": "HIGH",
    "category": "A10",
    "description": "Unvalidated requests.get",
    "remediation": "Whitelist URLs/domains."
  },
  {
    "name": "Python urllib urlopen",
    "pattern": "(?i)urllib\\.request\\.urlopen\\(",
    "severity": "HIGH",
    "category": "A10",
    "description": "urlopen()",
    "remediation": "Whitelist URLs/domains."
  },
  {
    "name": "Express.js IDOR Pattern",
    "pattern": "app\\.(get|post|put|delete)\\s*\\(['\"]/[^'\"/]+/:\\w+",
    "severity": "MEDIUM",
    "category": "A01",
    "description": "Potential Insecure Direct Object Reference (IDOR) pattern in Express.js route.",
    "remediation": "Ensure that all routes handling object IDs have strict authorization checks."
  },
  {
    "name": "JWT No Expiration",
    "pattern": "(?i)(?:jwt\\.sign\\(|jwt\\.create\\(|token\\.add).*\\)",
    "severity": "MEDIUM",
    "category": "A01",
    "description": "JWT without expiration",
    "remediation": "Always set appropriate token expiration."
  },
  {
    "name": "Open Redirect",
    "pattern": "(?i)(sendRedirect|res\\.redirect)\\(",
    "severity": "MEDIUM",
    "category": "A01",
    "description": "Redirect without validation",
    "remediation": "Whitelist redirect URLs."
  },
  {
    "name": "Rails Mass Assignment",
    "pattern": "(?i)params\\.permit\\(",
    "severity": "MEDIUM",
    "category": "A01",
    "description": "Potential mass assignment",
    "remediation": "Whitelist permitted fields explicitly."
  },
  {
    "name": "Go crypto/md5",
    "pattern": "(?i)md5\\.New\\(",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "crypto/md5",
    "remediation": "Use crypto/sha256."
  },
  {
    "name": "MD5",
    "pattern": "(?i)md5\\s*\\(",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "Weak MD5 hash",
    "remediation": "Use SHA-256 or better."
  },
  {
    "name": "Python hashlib md5",
    "pattern": "(?i)hashlib\\.md5\\(",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "hashlib.md5",
    "remediation": "Use hashlib.sha256."
  },
  {
    "name": "SHA1",
    "pattern": "(?i)sha1\\s*\\(",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "Weak SHA1 hash",
    "remediation": "Use SHA-256 or better."
  },
  {
    "name": "Weak PBKDF2 Iteration Count",
    "pattern": "(?i)pbkdf2.*(?:iterations|count)\\s*[<=]\\s*10000",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "Low PBKDF2 iteration count",
    "remediation": "Use â‰¥100k iterations for PBKDF2."
  },
  {
    "name": "Weak Random Generation",
    "pattern": "(?i)(?:Math\\.random\\(\\)|rand\\.Intn\\(|random\\.random\\(\\))",
    "severity": "MEDIUM",
    "category": "A02",
    "description": "Non-cryptographic random generator",
    "remediation": "Use secure random functions."
  },
  {
    "name": "No Rate Limiting on Auth",
    "pattern": "(?i)(POST|GET)\\s*/\\S*(login|auth|signin)\\b",
    "severity": "MEDIUM",
    "category": "A04",
    "description": "Auth endpoint lacks rate limiting",
    "remediation": "Apply rate limiting/throttling to auth endpoints."
  },
  {
    "name": "Schema Validation Disabled",
    "pattern": "(?i)validateSchema\\s*[:=]\\s*false",
    "severity": "MEDIUM",
    "category": "A04",
    "description": "Schema validation turned off",
    "remediation": "Enable input schema validation."
  },
  {
    "name": "Django Debug Mode Enabled",
    "pattern": "(?i)DEBUG\\s*=\\s*True",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Django is running with DEBUG = True, which can expose sensitive configuration.",
    "remediation": "Ensure DEBUG is set to False in all production settings files."
  },
  {
    "name": "Flask Debug",
    "pattern": "(?i)app\\.run\\(.*debug\\s*=\\s*True",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Debug mode on",
    "remediation": "Disable debug in prod."
  },
  {
    "name": "Hardcoded IP Address",
    "pattern": "(?i)\\b((?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)){3})\\b",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Hardcoded IPv4 address",
    "remediation": "Use DNS names or config management for IPs."
  },
  {
    "name": "Java Debug Enabled",
    "pattern": "(?i)spring\\.boot\\.devtools\\.restart\\.enabled\\s*=\\s*true",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Devtools in prod",
    "remediation": "Disable devtools in prod."
  },
  {
    "name": "Missing CSP Header",
    "pattern": "(?i)Content-Security-Policy:\\s*",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "CSP header missing",
    "remediation": "Define a strict CSP to lock down scripts/styles."
  },
  {
    "name": "Missing HSTS Header",
    "pattern": "(?i)Strict-Transport-Security:\\s*max-age=\\d+",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "HSTS header missing",
    "remediation": "Add `Strict-Transport-Security: max-age=63072000; includeSubDomains`."
  },
  {
    "name": "Missing HttpOnly/Secure Cookie",
    "pattern": "(?i)Set-Cookie:",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Insecure cookie flags",
    "remediation": "Set HttpOnly and Secure flags on cookies."
  },
  {
    "name": "Missing X-Content-Type-Options",
    "pattern": "(?i)X-Content-Type-Options:\\s*nosniff",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "X-Content-Type-Options header missing",
    "remediation": "Add `X-Content-Type-Options: nosniff`."
  },
  {
    "name": "Missing X-Frame-Options",
    "pattern": "(?i)X-Frame-Options:\\s*(DENY|SAMEORIGIN)",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "X-Frame-Options header missing",
    "remediation": "Add `X-Frame-Options: DENY` or `SAMEORIGIN`."
  },
  {
    "name": "Node.js Express Error Handler",
    "pattern": "(?i)app\\.use\\(errorHandler\\)",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "Default error handler",
    "remediation": "Use custom error handler."
  },
  {
    "name": "Open CORS Policy",
    "pattern": "(?i)Access-Control-Allow-Origin:\\s*\\*",
    "severity": "MEDIUM",
    "category": "A05",
    "description": "CORS policy allows any origin",
    "remediation": "Restrict CORS to trusted domains."
  },
  {
    "name": "Inline JS Handler",
    "pattern": "(?i)on\\w+\\s*=\\s*[\"'].*[\"']",
    "severity": "MEDIUM",
    "category": "A07",
    "description": "Inline JS event",
    "remediation": "Use addEventListener()."
  },
  {
    "name": "document.write",
    "pattern": "(?i)document\\.write\\s*\\(",
    "severity": "MEDIUM",
    "category": "A07",
    "description": "document.write used",
    "remediation": "Avoid document.write()."
  },
  {
    "name": "Go json.Unmarshal unchecked",
    "pattern": "(?i)json\\.Unmarshal\\(",
    "severity": "MEDIUM",
    "category": "A08",
    "description": "json.Unmarshal",
    "remediation": "Validate JSON before unmarshal."
  },
  {
    "name": "Exceptions Caught Without Logging",
    "pattern": "(?i)catch\\s*\\([^)]*\\)\\s*\\{",
    "severity": "MEDIUM",
    "category": "A09",
    "description": "Exception handler lacks logging",
    "remediation": "Log caught exceptions (e.g. `console.error(err)`)."
  },
  {
    "name": "Generic Exception Catch",
    "pattern": "catch\\s*\\(\\s*Exception\\s+e\\s*\\)",
    "severity": "MEDIUM",
    "category": "A09",
    "description": "Catching a generic Exception can hide specific, security-relevant errors.",
    "remediation": "Catch specific exception types to ensure proper error handling and logging."
  },

  {
    "name": "Spring Data JPA Native Query",
    "pattern": "(?i)@Query\\s*\\([^)]*nativeQuery\\s*=\\s*true",
    "severity": "HIGH",
    "category": "A03",
    "description": "Native SQL in Spring Data JPA - risk of injection if query uses string concatenation",
    "remediation": "Use JPQL or parameterized native queries; never concatenate user input."
  },
  {
    "name": "Spring Data JPA Query Concatenation",
    "pattern": "(?i)@Query\\s*\\([^)]*\\+\\s*",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "SQL/JPQL query built with string concatenation - SQL injection risk",
    "remediation": "Use parameterized queries with :param or ?1 placeholders."
  },
  {
    "name": "Spring permitAll Sensitive Path",
    "pattern": "(?i)(permitAll|anonymous\\(\\))\\s*\\.(antMatchers|requestMatchers)\\s*\\([^)]*(admin|api|internal|config)",
    "severity": "HIGH",
    "category": "A01",
    "description": "Sensitive path allowed without authentication",
    "remediation": "Require authentication for admin, api, and internal endpoints."
  },
  {
    "name": "Spring RestTemplate User URL",
    "pattern": "(?i)(RestTemplate|WebClient)\\.(get|post|exchange)\\s*\\([^)]*\\+\\s*",
    "severity": "HIGH",
    "category": "A10",
    "description": "HTTP client URL built with concatenation - SSRF risk",
    "remediation": "Validate and whitelist URLs before making requests."
  },
  {
    "name": "JPA EntityManager Native Query",
    "pattern": "(?i)(createNativeQuery|createQuery)\\s*\\([^)]*\\+\\s*",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "JPA/Hibernate query with string concatenation - SQL injection",
    "remediation": "Use parameterized queries with setParameter()."
  },
  {
    "name": "Spring @RequestBody to Repository",
    "pattern": "(?i)(repository|service)\\.(save|update)\\s*\\([^)]*request\\.getBody|@RequestBody.*\\.save\\(",
    "severity": "HIGH",
    "category": "A01",
    "description": "Request body passed directly to repository - mass assignment risk",
    "remediation": "Map and validate fields explicitly; use DTOs with allowed fields."
  },
  {
    "name": "Quarkus Permissions Disabled",
    "pattern": "(?i)quarkus\\.security\\.deny-unauthenticated\\s*=\\s*false",
    "severity": "HIGH",
    "category": "A01",
    "description": "Quarkus allows unauthenticated access",
    "remediation": "Enable authentication for production."
  },

  {
    "name": "Django raw() SQL",
    "pattern": "(?i)\\.raw\\s*\\([^)]*%s|\\.raw\\s*\\([^)]*\\+\\s*|\\.raw\\s*\\([^)]*f[\"']",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Django raw() with string formatting - SQL injection risk",
    "remediation": "Use parameterized queries: raw('SELECT * FROM t WHERE id = %s', [id])"
  },
  {
    "name": "Django extra() SQL",
    "pattern": "(?i)\\.extra\\s*\\([^)]*select\\s*=\\s*|\\.extra\\s*\\([^)]*where\\s*=",
    "severity": "HIGH",
    "category": "A03",
    "description": "Django extra() with raw SQL - injection risk if user input used",
    "remediation": "Use parameterized where; avoid user input in extra()."
  },
  {
    "name": "SQLAlchemy text() with f-string",
    "pattern": "(?i)text\\s*\\([^)]*f[\"']|text\\s*\\([^)]*%\\s*\\w|\\.execute\\s*\\([^)]*%\\s*",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "SQLAlchemy text() or execute with f-string/format - SQL injection",
    "remediation": "Use bindparams() or :param placeholders; never format/concatenate."
  },
  {
    "name": "FastAPI Body to ORM",
    "pattern": "(?i)(await\\s+)?(session\\.add|session\\.merge|db\\.add|db\\.merge)\\s*\\([^)]*body|Body\\(\\).*\\.add\\(",
    "severity": "HIGH",
    "category": "A01",
    "description": "FastAPI request body passed directly to ORM - mass assignment",
    "remediation": "Use Pydantic model with explicit fields; validate before persist."
  },
  {
    "name": "FastAPI Request in Query",
    "pattern": "(?i)session\\.(execute|query)\\s*\\([^)]*request\\.|db\\.query\\s*\\([^)]*request\\.",
    "severity": "HIGH",
    "category": "A03",
    "description": "Database query built from request - injection or IDOR risk",
    "remediation": "Validate and sanitize; use ORM query builders with params."
  },
  {
    "name": "Django ORM filter with F from request",
    "pattern": "(?i)\\.filter\\s*\\([^)]*request\\.(GET|POST|query_params)",
    "severity": "MEDIUM",
    "category": "A03",
    "description": "Django filter using request params directly - potential injection",
    "remediation": "Validate and type-check params; use allowlists for field names."
  },
  {
    "name": "Python format in SQL",
    "pattern": "(?i)(execute|executemany|raw)\\s*\\([^)]*\\.format\\s*\\(",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "SQL executed with str.format() - SQL injection",
    "remediation": "Use parameterized queries with %s or :param placeholders."
  },
  {
    "name": "Celery task with pickle",
    "pattern": "(?i)celery.*pickle|CELERY_ACCEPT_CONTENT.*pickle",
    "severity": "HIGH",
    "category": "A08",
    "description": "Celery accepting pickle serialization - deserialization RCE risk",
    "remediation": "Use JSON serialization; set CELERY_ACCEPT_CONTENT=['json']."
  },
  {
    "name": "Pydantic model_dump to ORM",
    "pattern": "(?i)\\.(create|add|insert)\\s*\\([^)]*\\.model_dump\\s*\\(|\\.create\\s*\\([^)]*\\*\\.model_dump",
    "severity": "HIGH",
    "category": "A01",
    "description": "Pydantic model_dump() passed to ORM - mass assignment if model has extra fields",
    "remediation": "Explicitly select fields: model_dump(include={'field1','field2'})."
  },
  {
    "name": "Prisma Unsafe Raw SQL",
    "pattern": "(?i)\\$queryRawUnsafe|\\$executeRawUnsafe|\\$queryRaw\\s*\\([^)]*\\+\\s*|\\$executeRaw\\s*\\([^)]*\\+",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Prisma raw SQL without parameterization - SQL injection risk",
    "remediation": "Use $queryRaw with Prisma.sql template literal; never $queryRawUnsafe with user input."
  },
  {
    "name": "React dangerouslySetInnerHTML",
    "pattern": "(?i)dangerouslySetInnerHTML\\s*=",
    "severity": "HIGH",
    "category": "A07",
    "description": "React dangerouslySetInnerHTML - XSS if content is user-controlled",
    "remediation": "Sanitize HTML (e.g. DOMPurify) or use textContent; avoid with user input."
  },
  {
    "name": "Go SQL with fmt.Sprintf",
    "pattern": "(?i)\\.(Exec|Query|QueryRow)\\s*\\([^)]*fmt\\.Sprintf",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Go SQL built with fmt.Sprintf - SQL injection risk",
    "remediation": "Use parameterized queries with ? placeholder and args."
  },
  {
    "name": "Ruby ActiveRecord Raw SQL",
    "pattern": "(?i)(execute|select_all|find_by_sql)\\s*\\([^)]*#\\{|ActiveRecord::Base\\.connection\\.execute\\s*\\([^)]*\\+",
    "severity": "CRITICAL",
    "category": "A03",
    "description": "Ruby ActiveRecord raw SQL with interpolation - SQL injection",
    "remediation": "Use parameterized queries: where('id = ?', id) or sanitize_sql_array."
  }
]
